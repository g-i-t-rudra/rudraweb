<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RUDRA Weekly Knowledge Drop</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link href="{{ url_for('static', filename='rudrastyle.css') }}" rel="stylesheet">

    <style>
        body {
            background: radial-gradient(circle, rgba(10, 10, 15, 1) 20%, rgba(1, 1, 2, 1) 80%);
            color: #e8f1f2;
            font-family: 'Poppins', sans-serif;
            overflow: auto;
            margin: 0;
        }

        #blackhole {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        canvas {
            width: 100%;
            height: 100%;
        }

        .content-wrapper {
            position: relative;
            z-index: 1;
            flex: 1;
        }

        .footer .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .footer ul {
            padding: 0;
            list-style: none;
        }

        .footer ul li {
            margin-bottom: 5px;
        }

        .container {
            max-width: 1000px;
            margin: 24px auto;
            border: 2px solid grey !important;
            background: rgba(20, 20, 30, 0.65) !important;
            padding: 24px !important;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.8);
        }

        .knowledge-drop-header img {
            width: 100%;
            max-height: 450px;
            object-fit: cover;
            border-bottom: 5px solid #68d4f2;
            border-radius: 12px 12px 0 0;
        }

        .knowledge-drop-content {
            margin-left: 4vw;
            margin-right: 4vw;
            margin-top: 16px;
        }

        .glowing-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 600;
            color: #68d4f2;
            margin-top: 20px;
            animation: glowEffect 3s infinite alternate;
        }

        @keyframes glowEffect {
            0% {
                text-shadow: 0 0 5px rgba(104, 212, 242, 0.3), 0 0 10px rgba(104, 212, 242, 0.2);
                opacity: 0.7;
            }
            50% {
                text-shadow: 0 0 20px rgba(104, 212, 242, 0.8), 0 0 30px rgba(104, 212, 242, 0.5);
                opacity: 1;
            }
            100% {
                text-shadow: 0 0 5px rgba(104, 212, 242, 0.3), 0 0 10px rgba(104, 212, 242, 0.2);
                opacity: 0.7;
            }
        }

        .date-display {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 8px;
            color: #b9e3e5;
        }

        .date-display svg {
            margin-right: 8px;
        }

        .subtitle {
            text-align: center;
            margin-top: 16px;
            color: #e8f1f2;
            font-style: italic;
            font-size: 1.25rem;
        }

        h2 {
            color: #68d4f2;
            font-weight: bold;
            font-size: 1.5rem;
            margin-top: 24px;
            text-transform: uppercase;
        }

        p, li {
            line-height: 1.75;
            font-size: 1.125rem;
            margin-bottom: 20px;
        }

        ul {
            list-style-type: disc;
            padding-left: 24px;
        }

        strong {
            font-weight: 600;
        }

        .math-formula {
            background: rgba(104, 212, 242, 0.1);
            padding: 16px;
            border-radius: 8px;
            border-left: 4px solid #68d4f2;
            margin: 20px 0;
            overflow-x: auto;
        }

        .reference-list {
            border-top: 1px solid rgba(104, 212, 242, 0.3);
            margin-top: 40px;
            padding-top: 20px;
        }

        .reference-list li {
            font-size: 0.95rem;
            margin-bottom: 10px;
        }
        .knowledge-content {
    margin-top: 20px;
    font-size: 16px;
    line-height: 1.6;
}

.knowledge-content h2, .knowledge-content h3 {
    margin-bottom: 10px;
    font-weight: bold;
}

.knowledge-content p {
    color: #333; /* Adjust if needed */
}

.knowledge-content hr {
    margin: 20px 0;
    border: 0;
    border-top: 1px solid #ccc;
}
.image-container {
    text-align: center;
    margin-top: 20px;
}

.image-container img {
    max-width: 100%;
    height: auto;
    border-radius: 8px; /* Optional for a polished look */
}
.code-block {
    background-color: inherit; /* Matches the surrounding background */
    color: inherit; /* Matches the text color */
    padding: 10px;
    border: 1px solid rgba(255, 255, 255, 0.2); /* Subtle border */
    border-radius: 5px;
    font-family: monospace;
    overflow-x: auto;
    word-wrap: break-word;
}
/* Styled List - Ensures a modern, clean look */
.styled-list {
    list-style-type: disc; /* Standard bullet points */
    padding-left: 20px; /* Proper indentation */
    color: #c9d1d9; /* Matches the siteâ€™s text color */
    font-size: 16px;
    line-height: 1.6;
}

/* List Unstyled - Removes default bullet points but keeps spacing */
.list-unstyled {
    list-style: none;
    padding: 0;
    margin: 0;
}
h3 {
    color: #9ecbff; /* Lighter than h2 for contrast */
    font-weight: bold;
    font-size: 1.25rem; /* Slightly smaller than h2 */
    margin-top: 20px;
    text-transform: capitalize; /* Avoids competing with h2 */
}
h4 {
    color: #b0d0ff; /* Lighter than h3 for contrast */
    font-weight: bold;
    font-size: 1.1rem; /* Smaller than h3 */
    margin-top: 18px;
    text-transform: none; /* Keeps it natural */
}
h1 {
    font-size: 36px; /* Increased size */
    font-weight: bold;
    text-align: center;
    color: #44ccff; /* Matches the blue text */
    margin-bottom: 10px; /* Adds spacing below */
    margin-top:40px;
}




    </style>
</head>
<body>
      <!-- Navbar Start -->
    <nav class="navbar navbar-expand-lg custom-navbar">
        <div class="container-fluid">
            <a class="navbar-brand" href="{{ url_for('home') }}">
                <img src="{{ url_for('static', filename='rudralogo9.jpeg') }}" alt="RUDRA Logo" class="logo" style="border-radius: 50%; width: 50px;">
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="{{ url_for('home') }}">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('comingsoon') }}">About Us</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                           Initiatives
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="{{ url_for('comingsoon') }}">Events</a>
                            <a class="dropdown-item" href="{{ url_for('comingsoon') }}">Weekly Knowledge Drops</a>
                            <a class="dropdown-item" href="{{ url_for('comingsoon') }}">Ask Me Anything Sessions</a>
                            <a class="dropdown-item" href="{{ url_for('comingsoon') }}">Study Jams</a>
                            <a class="dropdown-item" href="{{ url_for('comingsoon') }}">Courses</a>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('comingsoon') }}">Fun Moments</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

 <div id="blackhole"></div>

<div class="content-wrapper">
    <div class="container">
        <div class="knowledge-drop-header">
            <img src="{{ url_for('static', filename='Matrix.png') }}" alt="Matrix Factorization in Recommender Systems">
        </div>

        <div class="knowledge-drop-content">
            <h1 class="glowing-title">RUDRA Weekly Knowledge Drop</h1>
            
            <div class="date-display">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <h5 id="current-date"></h5>
            </div>

            <h1>Matrix Factorization in Recommender Systems</h1>

        <h2>Introduction</h2>
        <p>
            Recommender systems have become a fundamental part of modern digital platforms. They power 
            recommendations on streaming services like <strong>Netflix</strong>, e-commerce platforms like <strong>Amazon</strong>, 
            and social media feeds like <strong>Facebook</strong> and <strong>Instagram</strong>. One of the most effective techniques for 
            building recommender systems is <strong>matrix factorization</strong>. It allows us to predict user preferences 
            based on historical interactions. This article explores the concept, working, advantages, 
            and challenges of matrix factorization in recommender systems.
        </p>

        <h2>Understanding Recommender Systems</h2>
        <p>
            A <strong>recommender system</strong> is an algorithm designed to suggest relevant items (movies, books, 
            products) to users based on their past behavior. There are two major types of recommender 
            systems:
        </p>
        <ul class="styled-list">
            <li><strong>Content-Based Filtering:</strong> Recommends items similar to those a user has liked before.</li>
            <li><strong>Collaborative Filtering:</strong> Makes recommendations based on the preferences of similar users.</li>
        </ul>

        <h2>Collaborative Filtering</h2>
        <p>
            To address some of the limitations of content-based filtering, <strong>collaborative filtering</strong> uses 
            similarities between users and items simultaneously to provide recommendations. This allows for 
            serendipitous recommendations, meaning the system can suggest an item to user A based on 
            the interests of a similar user B. Furthermore, collaborative filtering models can learn 
            embeddings automatically, without relying on hand-engineered features.
        </p>

        <h2>Movie Recommendation Example</h2>
        <p>
            Consider a movie recommendation system in which the training data consists of a <strong>feedback matrix</strong>, 
            where:
        </p>
        <ul class="styled-list">
            <li>Each row represents a <strong>user</strong>.</li>
            <li>Each column represents an <strong>item (a movie)</strong>.</li>
                    <li>Each column represents an <strong>item (a movie)</strong>.</li>
        </ul>
    </li>
</ol>

<h3>Explicit vs. Implicit Feedback</h3>
<ul>
    <li>The feedback about movies falls into one of two categories:
        <ul>
            <li><strong>Explicit Feedback</strong> â€“ Users provide a numerical rating.</li>
            <li><strong>Implicit Feedback</strong> â€“ The system infers interest based on user behavior (e.g., watching a movie).</li>
        </ul>
    </li>
</ul>

<p>For simplicity, we assume the feedback matrix is binary (1 indicates interest in a movie).</p>

<p>When a user visits the homepage, the system should recommend movies based on:</p>
<ol>
    <li>Similarity to movies the user has liked in the past.</li>
    <li>Movies that similar users liked.</li>
</ol>

<h2>Matrix Factorization in Collaborative Filtering</h2>
<p>
    Matrix factorization is a mathematical technique used to decompose a large matrix into smaller, more manageable matrices.
    In recommender systems, this helps uncover <strong>latent factors</strong> (hidden patterns) in user-item interaction data.
</p>

<p>For example, consider a <strong>user-item interaction matrix</strong> where rows represent users, columns represent items (movies, products, etc.), and each cell contains a rating given by a user to an item.</p>

<p>Matrix factorization breaks this matrix into two lower-dimensional matrices:</p>
<ul>
    <li><strong>User matrix (U)</strong>: Represents users in terms of hidden features.</li>
    <li><strong>Item matrix (V)</strong>: Represents items in terms of hidden features.</li>
</ul>

<p>
    The goal is to approximate the original matrix as the product of these two matrices: R â‰ˆ U Ã— V<sup>T</sup>, 
    where R is the original ratings matrix.
</p>

<h2>Learning Embeddings for Users and Items</h2>

<h3>1D Embedding</h3>
<p>
    Suppose we assign each movie a <strong>scalar value</strong> that describes whether the movie is for children 
    (negative values) or adults (positive values). Similarly, we assign a scalar to each user that represents their 
    interest in <em>childrenâ€™s or adult movies</em>.
</p>
<p>
    The <strong>product</strong> of the movie embedding and the user embedding should be <strong>higher</strong> 
    (closer to 1) for movies the user is likely to enjoy.
</p>
<p>
    This approach explains some user preferences well but may not be sufficient for all cases.
</p>

<h3>2D Embedding</h3>
<p>
    To capture more complexity, we introduce a second feature: the degree to which each movie is 
    <strong>blockbuster vs. an arthouse film</strong>. With a second feature, we can now represent each movie with a 
    <strong>two-dimensional embedding</strong>.
</p>
<ul>
    <li>Each movie has an embedding based on two factors: <strong>child-friendly vs. adult</strong> and 
        <strong>blockbuster vs. arthouse</strong>.</li>
    <li>Each user is placed in the same space, allowing the system to predict which movies they will like 
        based on their preferences.</li>
</ul>
<p>
    This approach improves the modelâ€™s accuracy, as it better represents the diversity in user preferences.
</p>

<h2>Popular Matrix Factorization Techniques</h2>

<h3>1. Singular Value Decomposition (SVD)</h3>
<p>
    SVD is a popular decomposition technique that expresses the matrix as the product of three smaller matrices: 
    <strong>R â‰ˆ U Ã— S Ã— V<sup>T</sup></strong>, where:
</p>
<ul>
    <li><strong>U</strong> represents user preferences.</li>
    <li><strong>S</strong> is a diagonal matrix containing singular values.</li>
    <li><strong>V</strong> represents item characteristics.</li>
</ul>
<p>
    Netflixâ€™s recommendation engine famously used SVD to improve its production.
</p>

<h3>2. Alternating Least Squares (ALS)</h3>
<p>
    ALS optimizes user and item matrices by minimizing the difference between predicted and actual ratings. 
    It alternates between fixing the user matrix and solving for the item matrix, and vice versa, until convergence.
</p>

<h3>3. Non-Negative Matrix Factorization (NMF)</h3>
<p>
    Unlike SVD, NMF enforces non-negative constraints, making the factorized matrices more interpretable. 
    This is useful for understanding underlying user interests.
</p>

<h2>Hybrid Recommender Systems</h2>
<p>
    Matrix factorization can be integrated with deep learning techniques to create hybrid models. 
    Some advanced hybrid approaches include:
</p>
<ul>
    <li><strong>Neural Collaborative Filtering (NCF):</strong> Combines matrix factorization with deep neural 
        networks for improved user-item interaction modeling.</li>
    <li><strong>Factorization Machines (FM):</strong> Extends matrix factorization by capturing higher-order 
        feature interactions, making it suitable for sparse datasets.</li>
    <li><strong>Graph-Based Recommender Systems:</strong> Uses graph neural networks to learn embeddings 
        for users and items based on their relationships in a graph structure.</li>
</ul>

<h2>Advantages of Matrix Factorization</h2>
<ul>
    <li><strong>Scalability:</strong> Works well with large datasets.</li>
    <li><strong>Latent Factor Discovery:</strong> Uncovers hidden user preferences.</li>
    <li><strong>Improved Accuracy:</strong> Provides better recommendations through engaging methods.</li>
    <li><strong>Sparsity Handling:</strong> Works effectively even when the data matrix is sparse 
        (i.e., many missing values).</li>
    <li><strong>Flexibility:</strong> Can be extended with deep learning models for better accuracy.</li>
</ul>

<h3>Challenges and Limitations</h3>
<ol>
    <li><strong>Cold Start Problem:</strong> New users and items lack enough historical data for accurate recommendations.</li>
    <li><strong>Computational Cost:</strong> Training large matrices can be resource-intensive.</li>
    <li><strong>Overfitting:</strong> Risk of modeling noise instead of actual patterns.</li>
    <li><strong>Lack of Context Awareness:</strong> Matrix factorization does not consider external factors like user location.</li>
    <li><strong>Explainability Issues:</strong> Matrix factorization models are often seen as black boxes, making it difficult to explain recommendations.</li>
</ol>

<h2>Real-World Applications</h2>
<ul>
    <li><strong>Netflix:</strong> Uses matrix factorization for movie recommendations.</li>
    <li><strong>Amazon:</strong> Suggests products based on past purchases and interactions.</li>
    <li><strong>Spotify:</strong> Recommends music based on listening history.</li>
    <li><strong>YouTube:</strong> Suggests videos using collaborative filtering models.</li>
    <li><strong>LinkedIn:</strong> Suggests connections and job recommendations using hybrid recommender systems.</li>
</ul>

<h2>Conclusion</h2>
<p>
    Matrix Factorization is a cornerstone of modern recommender systems, enabling accurate and scalable predictions of user preferences. 
    By reducing the high-dimensional rating matrix into a set of latent factors, it provides better recommendations, improves user experience, 
    and efficiently handles large-scale applications. However, challenges such as the cold start problem, high computational costs, and lack of explainability remain. 
    Integrating matrix factorization with deep learning and context-aware techniques can create more intelligent and flexible recommendations.
</p>

<h2>References</h2>
<ol>
    <li>Koren, Y., Bell, R., & Volinsky, C. (2009). <em>Matrix Factorization Techniques for Recommender Systems.</em> Computer, 42(8), 30-37.</li>
    <li>Aggarwal, C. C. (2016). <em>Recommender Systems: The Textbook.</em> Springer.</li>
    <li>Rendle, S., Freudenthaler, C., & Schmidt-Thieme, L. (2010). <em>Factorizing Personalized Markov Chains for Next-Basket Recommendation.</em> Proceedings of the 19th International Conference on World Wide Web (WWW).</li>
</ol>







        </div>
    </div>
</div>

    <!-- Footer Start -->
    <footer class="footer">
        <div class="container">
            <div class="row d-flex justify-content-around">
                <div class="col-md-3">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="{{ url_for('knowledge_drop') }}">&#x3E; Latest Weekly Knowledge Drop</a></li>
                        <li><a href="https://forms.gle/Tv4uMC2mN9kQ7Dta7">&#x3E; Register for Microsoft Study Jams</a></li>
                        <li><a href="{{ url_for('comingsoon') }}">&#x3E; Register and Join RUDRA</a></li>
                        <li><a href="{{ url_for('comingsoon') }}">&#x3E; Explore Blogs</a></li>
                        <li><a href="#" class="go-to-top">&#x3E; Go to Top</a></li>
                    </ul>
                </div>
                <div class="col-md-3 text-center">
                    <h5>Follow Us</h5>
                    <ul class="social-icons">
                        <li><a href="https://www.instagram.com/rudra.rvu"><i class="fab fa-instagram"></i></a></li>
                        <li><a href="#"><i class="fab fa-linkedin"></i></a></li>
                        <li><a href="#"><i class="fab fa-github"></i></a></li>
                        <li><a href="#"><i class="fab fa-youtube"></i></a></li>
                        <li><a href="#"><i class="fab fa-twitter"></i></a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h5>Contact</h5>
                    <ul class="list-unstyled">
                        <li><a href="mailto:info@example.com"><i class="far fa-envelope"></i> Email</a></li>
                        <li>
                            <a href="mailto:contact.rudrarvu@gmail.com?cc=sujayvk.btech23@rvu.edu.in,adityas.btech23@rvu.edu.in,vaishnavs.btech23@rvu.edu.in">
                                <i class="far fa-envelope"></i> Contact Executive Board
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer End -->

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

    <script>
        // Set the current date
        document.addEventListener('DOMContentLoaded', function() {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            const currentDate = new Date().toLocaleDateString('en-US', options);
            document.getElementById('current-date').textContent = currentDate;
            
            // Initialize black hole
            blackhole('#blackhole');
        });
        
        // Black hole animation
        function blackhole(element) {
            var h = $(element).height(),
                w = $(element).width(),
                cw = w,
                ch = h,
                maxorbit = 255, // distance from center
                centery = ch/2,
                centerx = cw/2;

            var startTime = new Date().getTime();
            var currentTime = 0;

            var stars = [],
                collapse = false, // if hovered
                expanse = false; // if clicked

            var canvas = $('<canvas/>').attr({width: cw, height: ch}).appendTo(element),
                context = canvas.get(0).getContext("2d");

            context.globalCompositeOperation = "lighter";
            function setDPI(canvas, dpi) {
                if (!canvas.get(0).style.width)
                    canvas.get(0).style.width = canvas.get(0).width + 'px';
                if (!canvas.get(0).style.height)
                    canvas.get(0).style.height = canvas.get(0).height + 'px';

                var scaleFactor = dpi / 96;
                canvas.get(0).width = Math.ceil(canvas.get(0).width * scaleFactor);
                canvas.get(0).height = Math.ceil(canvas.get(0).height * scaleFactor);
                var ctx = canvas.get(0).getContext('2d');
                ctx.scale(scaleFactor, scaleFactor);
            }

            function rotate(cx, cy, x, y, angle) {
                var radians = angle,
                    cos = Math.cos(radians),
                    sin = Math.sin(radians),
                    nx = (cos * (x - cx)) + (sin * (y - cy)) + cx,
                    ny = (cos * (y - cy)) - (sin * (x - cx)) + cy;
                return [nx, ny];
            }

            setDPI(canvas, 192);

            var star = function(){
                var rands = [];
                rands.push(Math.random() * (maxorbit/2) + 1);
                rands.push(Math.random() * (maxorbit/2) + maxorbit);

                this.orbital = (rands.reduce(function(p, c) {
                    return p + c;
                }, 0) / rands.length);

                this.x = centerx;
                this.y = centery + this.orbital;
                this.yOrigin = centery + this.orbital;
                this.speed = (Math.floor(Math.random() * 2.5) + 1.5)*Math.PI/180;
                this.rotation = 0;
                this.startRotation = (Math.floor(Math.random() * 360) + 1)*Math.PI/180;
                this.id = stars.length;
                this.collapseBonus = this.orbital - (maxorbit * 0.7);
                
                if(this.collapseBonus < 0){
                    this.collapseBonus = 0;
                }

                stars.push(this);
                this.color = 'rgba(104, 212, 242,'+ (1 - ((this.orbital) / 255)) +')';
                this.hoverPos = centery + (maxorbit/2) + this.collapseBonus;
                this.expansePos = centery + (this.id%100)*-10 + (Math.floor(Math.random() * 20) + 1);
                this.prevR = this.startRotation;
                this.prevX = this.x;
                this.prevY = this.y;
            }
            
            star.prototype.draw = function(){
                if(!expanse){
                    this.rotation = this.startRotation + (currentTime * this.speed);
                    if(!collapse){
                        if(this.y > this.yOrigin){
                            this.y-= 2.5;
                        }
                        if(this.y < this.yOrigin-4){
                            this.y+= (this.yOrigin - this.y) / 10;
                        }
                    } else {
                        this.trail = 1;
                        if(this.y > this.hoverPos){
                            this.y-= (this.hoverPos - this.y) / -5;
                        }
                        if(this.y < this.hoverPos-4){
                            this.y+= 2.5;
                        }
                    }
                } else {
                    this.rotation = this.startRotation + (currentTime * (this.speed / 2));
                    if(this.y > this.expansePos){
                        this.y-= Math.floor(this.expansePos - this.y) / -140;
                    }
                }

                context.save();
                context.fillStyle = this.color;
                context.strokeStyle = this.color;
                context.beginPath();
                var oldPos = rotate(centerx,centery,this.prevX,this.prevY,-this.prevR);
                context.moveTo(oldPos[0],oldPos[1]);
                context.translate(centerx, centery);
                context.rotate(this.rotation);
                context.translate(-centerx, -centery);
                context.lineTo(this.x,this.y);
                context.stroke();
                context.restore();

                this.prevR = this.rotation;
                this.prevX = this.x;
                this.prevY = this.y;
            }

            $(window).on('resize', function(){
                h = $(element).height();
                w = $(element).width();
                cw = w;
                ch = h;
                centerx = cw/2;
                centery = ch/2;
                
                canvas.attr({width: cw, height: ch});
                setDPI(canvas, 192);
                stars = [];
                
                context.fillStyle = 'rgba(25,25,25,1)';
                context.fillRect(0, 0, cw, ch);
                for(var i = 0; i < 2000; i++){
                    new star();
                }
            });

            window.requestFrame = (function(){
                return  window.requestAnimationFrame       ||
                    window.webkitRequestAnimationFrame ||
                    window.mozRequestAnimationFrame    ||
                    function( callback ){
                    window.setTimeout(callback, 1000 / 60);
                };
            })();

            function loop(){
                var now = new Date().getTime();
                currentTime = (now - startTime) / 50;

                context.fillStyle = 'rgba(25,25,25,0.2)';
                context.fillRect(0, 0, cw, ch);

                for(var i = 0; i < stars.length; i++){
                    if(stars[i] != stars){
                        stars[i].draw();
                    }
                }

                requestFrame(loop);
            }

            function init(){
                context.fillStyle = 'rgba(25,25,25,1)';
                context.fillRect(0, 0, cw, ch);
                for(var i = 0; i < 2000; i++){
                    new star();
                }
                loop();
            }
            
            init();
            
            $('.container').on('mouseover', function(){
                collapse = true;
            }).on('mouseout', function(){
                collapse = false;
            });
        }
        
    </script>
</body>
</html>
